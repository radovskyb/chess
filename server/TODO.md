- fix race conditions on server
- add disconnect channel
- maybe restructure?
